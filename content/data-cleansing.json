{
  "id": "data-cleansing",
  "title": "Data Cleansing & Standardization",
  "subtitle": "Cleaning and standardizing vendor spend data",
  "lastUpdated": "2025-01-21",
  "content": "<div class='data-cleansing-content'><h2>Data Cleansing & Standardization</h2><p>File management and vendor normalization. Transform raw data into analysis-ready format. This phase typically takes <strong>Days 8-12 (Phase 4)</strong> and is crucial for accurate categorization.</p><div class='timeline-item'><div class='timeline-header'><h3 class='timeline-title'>Pre-Cleansing File Management</h3><span class='timeline-duration'>Days 8-12 (Phase 4)</span></div><ul class='checklist'><li><input type='checkbox' id='file-1'> <label for='file-1'>Create cleansed, uncategorized data file</label></li><li><input type='checkbox' id='file-2'> <label for='file-2'>Copy dataset into working copy</label></li><li><input type='checkbox' id='file-3'> <label for='file-3'>Create index column in column \"A\" for sort-back capability</label></li><li><input type='checkbox' id='file-4'> <label for='file-4'>Record baseline metrics (rows, suppliers, spend)</label></li></ul></div><div class='timeline-item'><div class='timeline-header'><h3 class='timeline-title'>Vendor Normalization Process</h3><span class='timeline-duration'>Days 9-11 (Parallel with Dashboard Design)</span></div><h4>Automated Normalization:</h4><ul class='checklist'><li><input type='checkbox' id='auto-1'> <label for='auto-1'>Apply fuzzy matching (PowerBI/R/Python)</label></li><li><input type='checkbox' id='auto-2'> <label for='auto-2'>Leverage Vendor ID when available</label></li><li><input type='checkbox' id='auto-3'> <label for='auto-3'>Generate automated match suggestions</label></li></ul><h4>Manual Verification:</h4><ul class='checklist'><li><input type='checkbox' id='manual-1'> <label for='manual-1'>Review all automated changes</label></li><li><input type='checkbox' id='manual-2'> <label for='manual-2'>Sort alphabetically for efficient review</label></li><li><input type='checkbox' id='manual-3'> <label for='manual-3'>Preserve maximum detail (e.g., \"Pepsi Co\" over \"Pepsi\")</label></li><li><input type='checkbox' id='manual-4'> <label for='manual-4'>Research business suffix additions carefully</label></li></ul></div><div class='timeline-item'><div class='timeline-header'><h3 class='timeline-title'>Data Standardization</h3></div><ul class='checklist'><li><input type='checkbox' id='std-1'> <label for='std-1'>Remove duplicates (Excel: Data → Remove Duplicates)</label></li><li><input type='checkbox' id='std-2'> <label for='std-2'>Standardize currency formats</label></li><li><input type='checkbox' id='std-3'> <label for='std-3'>Apply consistent date formatting (YYYY-MM-DD)</label></li><li><input type='checkbox' id='std-4'> <label for='std-4'>Clean description fields</label></li><li><input type='checkbox' id='std-5'> <label for='std-5'>Retain negative spend (categorize as returns/credits)</label></li><li><input type='checkbox' id='std-6'> <label for='std-6'>Obtain client sign-off on final spend total</label></li></ul></div><h3>Cleansing Steps Overview</h3><div class='process-flow'><div class='step-card'><span class='step-number'>1</span><h4>Remove Duplicates</h4><p>Identify and eliminate duplicate records</p></div><div class='step-arrow'>→</div><div class='step-card'><span class='step-number'>2</span><h4>Standardize Vendors</h4><p>Consolidate vendor variations</p></div><div class='step-arrow'>→</div><div class='step-card'><span class='step-number'>3</span><h4>Fix Data Types</h4><p>Correct formats and types</p></div><div class='step-arrow'>→</div><div class='step-card'><span class='step-number'>4</span><h4>Handle Missing Values</h4><p>Fill or flag incomplete data</p></div></div><h3>1. Vendor Name Standardization</h3><div class='standardization-section'><h4>Common Vendor Variations</h4><table class='variation-table'><thead><tr><th>Original</th><th>Standardized</th><th>Rule Applied</th></tr></thead><tbody><tr><td>IBM Corp.</td><td>IBM Corporation</td><td>Expand abbreviations</td></tr><tr><td>IBM CORPORATION</td><td>IBM Corporation</td><td>Proper case</td></tr><tr><td>I.B.M.</td><td>IBM Corporation</td><td>Remove periods</td></tr><tr><td>Microsoft Inc</td><td>Microsoft Corporation</td><td>Standardize suffix</td></tr><tr><td>Amazon.com</td><td>Amazon</td><td>Remove domain</td></tr></tbody></table><h4>Standardization Rules</h4><ol><li>Convert to proper case</li><li>Remove special characters (except &)</li><li>Expand common abbreviations (Corp, Inc, Ltd)</li><li>Remove leading/trailing spaces</li><li>Consolidate multiple spaces</li><li>Apply vendor master mapping</li></ol></div><h3>2. Address Data Issues</h3><ul class='checklist'><li><input type='checkbox' id='clean-1'> <label for='clean-1'>Remove duplicate invoices</label></li><li><input type='checkbox' id='clean-2'> <label for='clean-2'>Standardize vendor names</label></li><li><input type='checkbox' id='clean-3'> <label for='clean-3'>Fix date formats (MM/DD/YYYY)</label></li><li><input type='checkbox' id='clean-4'> <label for='clean-4'>Convert amounts to base currency</label></li><li><input type='checkbox' id='clean-5'> <label for='clean-5'>Remove cancelled/reversed transactions</label></li><li><input type='checkbox' id='clean-6'> <label for='clean-6'>Exclude tax amounts</label></li><li><input type='checkbox' id='clean-7'> <label for='clean-7'>Map to valid GL codes</label></li><li><input type='checkbox' id='clean-8'> <label for='clean-8'>Standardize department names</label></li></ul><h3>3. Power Query Transformation Steps</h3><pre class='code-block'>// Power Query M Code for Data Cleansing\nlet\n    Source = Excel.Workbook(File.Contents(\"VendorSpend.xlsx\")),\n    Data = Source{[Name=\"RawData\"]}[Data],\n    \n    // Promote headers\n    PromotedHeaders = Table.PromoteHeaders(Data),\n    \n    // Change data types\n    TypedData = Table.TransformColumnTypes(PromotedHeaders,{\n        {\"Invoice_Date\", type date},\n        {\"Amount\", type number},\n        {\"Vendor_ID\", type text}\n    }),\n    \n    // Remove duplicates\n    RemovedDuplicates = Table.Distinct(TypedData, {\"Invoice_Number\", \"Vendor_ID\"}),\n    \n    // Standardize vendor names\n    StandardizedVendors = Table.TransformColumns(RemovedDuplicates,{\n        {\"Vendor_Name\", each Text.Proper(Text.Trim(_))}\n    }),\n    \n    // Filter out reversals\n    FilteredData = Table.SelectRows(StandardizedVendors, each [Amount] > 0),\n    \n    // Add calculated columns\n    AddedColumns = Table.AddColumn(FilteredData, \"Year\", each Date.Year([Invoice_Date]))\n    \nin\n    AddedColumns</pre><h3>4. Data Validation Rules</h3><div class='validation-rules'><div class='rule-card'><h4>Amount Validation</h4><ul><li>Must be positive (>0)</li><li>Cannot exceed $10M per invoice</li><li>Should match PO amount ±10%</li></ul></div><div class='rule-card'><h4>Date Validation</h4><ul><li>Cannot be future dated</li><li>Must be within analysis period</li><li>Invoice date ≥ PO date</li></ul></div><div class='rule-card'><h4>Vendor Validation</h4><ul><li>Must exist in vendor master</li><li>Cannot be employee vendor</li><li>Must have valid tax ID</li></ul></div></div><h3>5. Output Files</h3><div class='output-section'><h4>Cleansed Data Structure</h4><table class='structure-table'><thead><tr><th>Column Name</th><th>Data Type</th><th>Required</th><th>Example</th></tr></thead><tbody><tr><td>Vendor_ID</td><td>Text</td><td>Yes</td><td>V12345</td></tr><tr><td>Vendor_Name_Std</td><td>Text</td><td>Yes</td><td>Microsoft Corporation</td></tr><tr><td>Invoice_Number</td><td>Text</td><td>Yes</td><td>INV-2024-001</td></tr><tr><td>Invoice_Date</td><td>Date</td><td>Yes</td><td>01/15/2024</td></tr><tr><td>Amount_USD</td><td>Number</td><td>Yes</td><td>5,250.00</td></tr><tr><td>Category_L1</td><td>Text</td><td>No</td><td>IT</td></tr><tr><td>Department</td><td>Text</td><td>Yes</td><td>Finance</td></tr><tr><td>GL_Account</td><td>Text</td><td>Yes</td><td>6100-520</td></tr></tbody></table></div><h3>Quality Metrics After Cleansing</h3><div class='metrics-box'><h4>Target Metrics</h4><ul><li>✅ Data Completeness: >98%</li><li>✅ Vendor Standardization: 100%</li><li>✅ Valid Dates: 100%</li><li>✅ Currency Conversion: 100%</li><li>✅ Duplicate Removal: 100%</li></ul></div><div class='tip-box'><i class='fas fa-lightbulb'></i><p><strong>Best Practice:</strong> Always maintain an audit trail. Create a log file documenting all transformations applied, records removed, and mappings used.</p></div></div>",
  "checklistItems": [
    "clean-1", "clean-2", "clean-3", "clean-4",
    "clean-5", "clean-6", "clean-7", "clean-8"
  ],
  "resources": [
    {
      "title": "Vendor Mapping Template",
      "type": "template",
      "url": "/assets/templates/vendor-mapping.xlsx"
    },
    {
      "title": "Power Query Scripts",
      "type": "code",
      "url": "/assets/scripts/power-query-cleansing.txt"
    },
    {
      "title": "Data Cleansing Log",
      "type": "template",
      "url": "/assets/templates/cleansing-log.xlsx"
    }
  ]
}